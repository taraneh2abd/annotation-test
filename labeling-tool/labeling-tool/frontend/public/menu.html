<!-- menu.html -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Menu - Image Labeling Tool</title>
<style>
body {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  margin:0; padding:0;
  background:#0f172a; color:#e2e8f0;
  display:flex; justify-content:center; align-items:center;
  height:100vh;
}
#menu {
  display:flex; flex-direction:column; align-items:center;
}
button {
  background:#1f2937; color:#e5e7eb;
  border:1px solid #334155;
  padding:12px 18px; border-radius:10px;
  margin:10px; cursor:pointer; width:220px;
  text-align:center; font-size:15px;
}
button:hover { background:#374151; }
</style>
</head>
<body>
<div id="menu">
  <h2 style="margin-bottom:20px;">Main Menu</h2>
  <button id="uploadBatchBtn">Upload batch as ZIP</button>
  <button id="uploadImagesBtn">Upload non labeled images as ZIP</button>
  <button id="labelingBtn">Labeling the query number...</button>
</div>

<script>
const API = 'http://localhost:8000';

// upload batch
// upload batch
// upload batch
document.getElementById('uploadBatchBtn').addEventListener('click', () => {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = '.zip';
  input.onchange = async () => {
    const file = input.files[0];
    if(file){
      const formData = new FormData();
      formData.append('file', file);
      const res = await fetch(`${API}/api/upload_batch`, {
        method: 'POST',
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('TOKEN') },
        body: formData
      });
      const data = await res.json();
      alert(`Batch uploaded: ${data.filename}`);
    }
  };
  input.click();
});

// upload non-labeled images
document.getElementById('uploadImagesBtn').addEventListener('click', () => {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = '.zip';
  input.onchange = async () => {
    const file = input.files[0];
    if(file){
      const formData = new FormData();
      formData.append('file', file);
      const res = await fetch(`${API}/api/upload_non_labeled`, {   // <-- FIXED endpoint
        method: 'POST',
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('TOKEN') },
        body: formData
      });
      const data = await res.json();
      alert(`Non-labeled images uploaded: ${data.filename}`);
    }
  };
  input.click();
});

// go to labeling input page
document.getElementById('labelingBtn').addEventListener('click', () => {
  let queryNum = prompt("Enter labeling query number (1-based):");
  if (queryNum) {
    // Convert to 0-based index for internal use
    const batchIndex = parseInt(queryNum, 10) - 1;
    window.location.href = `app.html?query=${encodeURIComponent(batchIndex)}`;
  }
});

</script>
</body>
</html>
